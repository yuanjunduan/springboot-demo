package cn.com.dyj.rpc;

import com.fasterxml.jackson.databind.ObjectMapper;

import lombok.extern.slf4j.Slf4j;

import net.sf.json.JSONObject;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.stereotype.Service;
import org.springframework.util.LinkedMultiValueMap;
import org.springframework.util.MultiValueMap;
import org.springframework.web.client.RestTemplate;

import java.util.Arrays;

/**
 * Created by liufei on 2017/8/16.
 */
@Slf4j
@Service
public class SendSmsService {

  private static final ObjectMapper MAPPER = new ObjectMapper();
  @Value("${sms.send.limit}")
  private int limit = 1000;
  @Value("${sms.url}")
  private String smsUrl;
  @Autowired
  private RestTemplate restTemplate;

  /**
   * 发放红包
   *
   * @param userId 非空
   * @return boolean
   */
  public boolean sendRedPackets(final Long userId) {

    final String url = "";

    final MultiValueMap<String, String> paramMap = new LinkedMultiValueMap<>();
    paramMap.add("userId", String.valueOf(userId));//传递参数


    log.info("Start to call create generate bonus api, url[ " + url + " ], param[ " + paramMap + " ]");
    final JSONObject jsonResult = this.restTemplate.postForObject(url, paramMap, JSONObject.class);
    log.info("End, result[ " + jsonResult + " ]");

    if (jsonResult.getBoolean("success")) {
      return true;
    } else {
      return false;
    }


  }
//  @PostConstruct
//  public void init() {
//    final BasicAuthConfiguration config = new BasicAuthConfiguration();
//    config.setAuthServerUrl(keyCloakConfigure.getAuthServerUrl());
//    config.setCredentialSecret(keyCloakConfigure.getCredentialsSecret());
//    config.setResource(keyCloakConfigure.getResource());
//    config.setRealm(keyCloakConfigure.getRealm());
//    config.setUsername(keyCloakConfigure.getUsername());
//    config.setPassword(keyCloakConfigure.getPassword());
//
//    basicToken = new BasicAuthToken(config);
//  }

  /*private HttpHeaders getHeaders() {
    final HttpHeaders headers = new HttpHeaders();
    headers.setAccept(Arrays.asList(new MediaType[]{MediaType.APPLICATION_JSON}));
    headers.setContentType(MediaType.APPLICATION_JSON);
    headers.set("X-Request-ID", String.valueOf(System.currentTimeMillis()));
    headers.add("authorization", "Bearer " + basicToken.getToken());
    return headers;
  }*/
}


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































